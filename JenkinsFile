pipeline {
    agent any

    stages {
        stage('Nettoyage') {
            steps {
                git 'https://github.com/FlorentEstur/MavenTest.git'
                bat "mvn -Dmaven.test.failure.ignore=true clean package"
            }
            
            post{
		success {
			echo "Succès du clean"
			}
        	}
        }
        
        stage('Test') {
            steps {
                bat "mvn test"
            }
            
        post {
        	failure {
        	    echo "Echec"
        	    mail to: "estur.florent@gmail;com",
        	    subject "Echec pipeline : ${currentBuild.fullDisplayName}",
        	    body: "Erreur dans le build : ${env.BUILD_URL}"
        	    }
            
        }
    }
    
    	stage('Installation') {
    		steps {
		    	bat "mvn install"
		    	}
    		}
    	
	    	post {
		    	always{
		    	echo "Le build a bien été lancé depuit github"
		    	}
    	
		}
	}
}
